# 5-xo-test-googlesheetsapi #

##“ест дл€ Data Analyst (использование Python и Google sheets API) ##

«адание:

¬ывести отчЄт по за€вкам за произвольный период в дн€х (от 1 дн€ и более)
ƒанные нужно забрать с помощью Google Sheets API из документа https://docs.google.com/spreadsheets/d/1Ycg7zTxds9DZnDvTrFcyNNKuTUxg6Yy6WF0a8Wc02WQ
‘ормат отчЄта:
-Dimensions
-канал привлечени€ за€вки (d_utm_source)
-клуб (d_club)
-менеджер (d_manager)

Metrics
-количество за€вок
-количество мусорных за€вок (на основании за€вки не создан клиент)
-количество новых за€вок (не было за€вок и покупок от этого клиента раньше)
-количество покупателей (кто купил в течение недели после за€вки)
-количество новых покупателей (кто купил в течение недели после за€вки, и не покупал раньше)
-доход от покупок новых покупателей

»тоговый отчЄт нужно вывести в свой документ Google Sheets:
-ƒл€ обработки данных написать код на Python
-ƒанные выгружать из Google Sheets и загружать в свой документ через Google Sheets API
-ƒл€ итогового отчЄта использовать pivot table Google Sheets
-(Ѕонусное задание, необ€зательно) вывести итоговый отчЄт в виде pivot table DataStudio (невыполнено, нехватило времени)

 омментарии к решению:

Ќеобходимо р€дом со скриптом положить ваши google credentials (€ использовал дл€ десктопного приложени€, с авторизацией через вебсайт)
¬ первый запуск, скрипт попросит разрешени€ на чтение/запись гугл таблиц и на все действи€ на гугл диске.
ѕосле этого сохранит токен в файл и при последующих запусках разрешени€ не будут запрашиватьс€.

 омментарии к исходным данным:
-если l_client_id = 00000000-0000-0000-0000-000000000000 то считаем что такого клиента не сущесутвует, значит это мусорна€ за€вка по которой не создан клиент
-есть транзакции с одинаковым id и временем, но с разными суммами. ѕо идее нужно обсудить как их обрабатывать. я просто суммирую все.
